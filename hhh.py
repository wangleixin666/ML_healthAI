# coding:utf-8
# 清洗数据中的坏数据
import pandas as pd
import numpy as np


def clean_label(s):
    x = str(s)
    if ' ' in x:
        i = x.index(' ')
        x = x[0:i]
    if '-' in x:
        i = x.index('-')
        x=x[0:i]
    return x


# 数据清洗
def data_clean(df):
    for c in ['1814', '1815', '190', '191', '1840', '192', '1850', '1117', '193', '314', '1115', '183', '2174',
              '10002', '10003', '31', '312', '2333', '100006', '320', '1845', '320', '2406', '1345', '2420',
              '155', '360', '1127', '269013', '269011', '269006', '979012', '979021', '979016', '979004',
              '979007', '979020', '979017', '979008', '979011', '979009', '979003', '979015', '979023',
              '979022', '979001', '979014', '979013', '979018', '979019', '979002', '979006', '979005',
              '300021', '300019', '1106', '139', '1107', '300018', '143', '669002', '669001', '1474',
              '669006', '300017', '100014', '100012', '1112', '2386', '100013', '2177', '809025',
              '809021', '10009', '300001', '2409', '2376', '300013', '669021', '2302', '069023',
              '10014', '31', '339122', '339131', '699001', '709024', '819014', 'P19033']:
        df[c] = df[c].apply(clean_label)
        df[c] = df[c].astype('float64')
    return df

test_data = pd.read_csv(r'D:/kaggle/health/190.csv', sep=',', encoding='utf-8')
data = data_clean(test_data)
data.to_csv(r'D:/kaggle/health/190_1.csv', encoding='utf-8')
